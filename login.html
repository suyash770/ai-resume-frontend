<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATS Portal | Authentication</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { background: #f8fafc; font-family: 'Inter', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .auth-card { background: white; padding: 2.5rem; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px; }
        .auth-card h1 { color: #7c3aed; text-align: center; margin-bottom: 1.5rem; font-size: 1.8rem; }
        .form-group { margin-bottom: 1.2rem; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 600; color: #64748b; margin-bottom: 6px; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        
        .auth-btn { width: 100%; background: #7c3aed; color: white; border: none; padding: 14px; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; justify-content: center; align-items: center; }
        .auth-btn:hover { background: #6d28d9; }
        
        /* Spinner & Success UI */
        .spinner { display: none; width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #fff; animation: spin 0.8s linear infinite; margin-right: 8px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading .spinner { display: inline-block; }
        .loading .btn-text { display: none; }
        .success-icon { display: none; color: #22c55e; font-weight: bold; text-align: center; margin-bottom: 1rem; }
        
        .toggle-link { text-align: center; margin-top: 1rem; font-size: 0.85rem; color: #7c3aed; cursor: pointer; }
    </style>
</head>
<body>

    <div class="auth-card" id="authCard">
        <div id="successAnim" class="success-icon"></div>
        <h1 id="formTitle">ATS Login</h1>
        
        <div class="form-group">
            <label>Select Role</label>
            <select id="userRole">
                <option value="hr">HR Panel</option>
                <option value="admin">Admin Panel</option>
                <option value="candidate">Candidate Panel</option>
            </select>
        </div>

        <div id="signupFields" style="display:none;">
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="regName" placeholder="Full Name">
            </div>
            <div class="form-group">
                <label>Mobile Number</label>
                <input type="tel" id="regMobile" placeholder="10-digit Mobile">
            </div>
        </div>

        <div class="form-group">
            <label>Email ID</label>
            <input type="email" id="userEmail" placeholder="name@gmail.com">
        </div>
        
        <div class="form-group">
            <label>Password</label>
            <input type="password" id="userPass" placeholder="••••••••">
        </div>

        <button id="authBtn" onclick="handleAuth()" class="auth-btn">
            <span class="spinner"></span>
            <span class="btn-text" id="btnText">Login</span>
        </button>

        <div class="toggle-link" onclick="toggleAuthMode()" id="toggleText">Don't have an account? Sign Up</div>
    </div>

    <script src="script.js"></script>
    <script>
        let isLoginMode = true;

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            document.getElementById("formTitle").innerText = isLoginMode ? "ATS Login" : "Create Account";
            document.getElementById("btnText").innerText = isLoginMode ? "Login" : "Register";
            document.getElementById("signupFields").style.display = isLoginMode ? "none" : "block";
            document.getElementById("toggleText").innerText = isLoginMode ? "Don't have an account? Sign Up" : "Already have an account? Login";
        }

        async function handleAuth() {
            const role = document.getElementById("userRole").value;
            const email = document.getElementById("userEmail").value;
            const pass = document.getElementById("userPass").value;

            if (isLoginMode) {
                // Calls loginUser in script.js
                await loginUser(email, pass, role);
            } else {
                const name = document.getElementById("regName").value;
                const mobile = document.getElementById("regMobile").value;
                // Calls registerUser in script.js
                const success = await registerUser(name, email, mobile, pass, role);
                if (success) {
                    setTimeout(() => { toggleAuthMode(); }, 2000);
                }
            }
        }
    </script>
</body>
</html>